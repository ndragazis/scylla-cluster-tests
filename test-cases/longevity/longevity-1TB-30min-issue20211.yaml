# copied from longevity-10gb-3h.yaml
# Reproducer for scylladb issues 20211.

test_duration: 255

stress_cmd:
  - "cassandra-stress write cl=QUORUM duration=60m -schema 'replication(strategy=NetworkTopologyStrategy,replication_factor=1)' -mode cql3 native -rate threads=1000 -col 'size=FIXED(1024) n=FIXED(1)' -pop seq=1..1000000000 -log interval=5"

scylla_version: '6.1.0'

n_db_nodes: 2
n_loaders: 1
n_monitor_nodes: 1

instance_provision: 'spot'
#instance_provision_fallback_on_demand: true

region_name: 'eu-west-1'

instance_type_db: 'r6a.2xlarge'
instance_type_loader: 'c6i.2xlarge'
instance_type_monitor: 't3.large'

# FIXME: No config option for throughput.
# Do it manually and reuse cluster.
data_volume_disk_num: 1
data_volume_disk_type: 'gp3'
data_volume_disk_size: 1024
data_volume_disk_iops: 12000
data_volume_disk_throughput: 1000

append_scylla_args: '--blocked-reactor-notify-ms 10 --abort-on-lsa-bad-alloc 1 --abort-on-seastar-bad-alloc --abort-on-internal-error 1 --abort-on-ebadf 1'

#run_fullscan: ['{"mode": "table_and_aggregate", "ks_cf": "keyspace1.standard1", "interval": 10}']

ssh_transport: 'libssh2'

user_prefix: 'longevity-1TB-30min-aws'
space_node_threshold: 64424

run_db_node_benchmarks: true
store_perf_results: true
